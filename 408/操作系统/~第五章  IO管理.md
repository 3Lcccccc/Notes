# 5.1 I/O管理概述

## 5.1.1 I/O设备

**按特性分类**
1. 人机交互类外部设备
2. 存储设备
3. 网络通信设备

**按传输速率分类**

1. 低速设备
2. 中速设备
3. 高速设备

**按信息交互的单位分类**

1. 块设备
   1. 传输快，可寻址
2. 字符设备
   1. 传输慢，不可寻址

## 5.1.2 I/O控制方式

**I/O控制器**
1. 接收和识别CPU发出的命令
2. 向CPU报告设备的状态
3. 数据交换
4. 地址识别
***
1. 程序直接控制方式
   1. ![](2021-07-16-09-48-04.png)  
   2. CPU干预频繁
   3. 数据按字传输  
   4. 数据流向
      1. 读：I/O设备$\rightarrow$CPU(内的寄存器)$\rightarrow$内存
      2. 写：内存$\rightarrow$CPU$\rightarrow$I/O设备
   5. 优缺点
      1. 👍优点：实现简单
      2. 👎缺点：CPU与I/O设备只能串行的工作，CPU需要一直检查，CPU利用率低
2. 中断驱动方式
   1. ![](2021-07-16-09-55-47.png)
   2. CPU只需要在开始之前和完成之后介入
   3. 按照传输
   4. 数据流向
      1. 读：I/O设备$\rightarrow$CPU(内的寄存器)$\rightarrow$内存
      2. 写：内存$\rightarrow$CPU$\rightarrow$I/O设备
   5. 优缺点
      1. 👍优点：与"程序直接控制方式"相比，CPU利用率明显提高
      2. 👎缺点：CPU与I/O设备只能串行的工作，CPU需要一直检查，CPU利用率低
3. DMA方式
   1. ![](2021-07-16-10-03-27.png)
   2. 开始和结束时干预
   3. 数据按块(可以多个连续的块)传输
   4. 数据流向
      1. 读：I/O设备$\rightarrow$内存
      2. 写：内存$\rightarrow$I/O设备
   5. 优缺点
      1. 👍优点：数据以块传输，CPU的介入频率进一步降低，CPU和I/O设备的并行性能得到提升
      2. 👎缺点：只能传输连续的块否则需要多条指令
4. 通道控制方式
   1. ![](2021-07-16-10-15-09.png)
   2. 只有完成一组数据块的读写时CPU才会干预
   3. 每次传输一组数据块
   4. 数据流向(在通道的控制下)
      1. 读：I/O设备$\rightarrow$内存
      2. 写：内存$\rightarrow$I/O设备
   5. 优缺点
      1. 👍优点：CPU、通道、I/O设备可以并行工作，资源利用率极高
      2. 👎缺点：实现复杂

## 5.1.3 I/O 子系统的层次结构
1. 用户层软件
   - 实现了与用户交互的接口。
2. 设备独立性软件(系统调用处理程序)
   - 向上提供了系统调用，并且负责处理系统调用
   - 对设备的保护
   - 差错处理
   - 设备的分配与回收
   - 数据缓冲区管理
   - 建立逻辑设备名到物理设备名的映射关系(使用逻辑设备表LUT)；根据设备类型选择调用相应的驱动程序
3. 设备驱动程序
   - 主要负责对硬件设备的具体控制，将上层发出的一系列命令转换特定设备"能听得懂"的一系列操作。包括设置设备寄存器；检查设备状态等
4. 中断处理程序
   - 进行中断处理
5. 硬件
   - 执行I/O操作

**I/O请求从上至下
I/O应答从下至上**